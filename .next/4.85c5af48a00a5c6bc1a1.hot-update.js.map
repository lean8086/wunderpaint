{"version":3,"file":"4.85c5af48a00a5c6bc1a1.hot-update.js","sources":["webpack:///containers/Workspace.js"],"sourcesContent":["import { Component } from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\nimport { updateCanvas } from '../store';\nimport Layer from '../components/Layer';\n\nclass Workspace extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      isToolExecuting: false,\n    };\n  }\n\n  snapshot() {\n    this.props.sync(this.layer.getImageData());\n    this.timer = setTimeout(() => this.props.sync(), 3 * 1000);\n  }\n\n  handleEvent(actionName, ev) {\n    if (!tools[this.props.tool][actionName]) return;\n    const { tool, color, scale } = this.props;\n    const pageX = ev.pageX || ev.touches[0].pageX || 0;\n    const pageY = ev.pageY || ev.touches[0].pageY || 0;\n\n    // TODO: move to state\n    tools[tool][actionName]({\n      x: Math.round((pageX - this.layer.canvas.offsetLeft + this.element.scrollLeft) / scale - .5),\n      y: Math.round((pageY - this.layer.canvas.offsetTop + this.element.scrollTop) / scale - .5),\n      color,\n      scale,\n      shadowLayer: this.shadowLayer,\n      layer: this.layer,\n    });\n  }\n\n  handleClick(ev) {\n    this.setState({ isToolExecuting: false });\n    this.handleEvent('handleClick', ev);\n  }\n\n  handleMouseDown(ev) {\n    this.setState({ isToolExecuting: true });\n    this.handleEvent('handleMouseDown', ev);\n    if (this.timer) clearTimeout(this.timer);\n  }\n\n  handleMouseUp(ev) {\n    this.setState({ isToolExecuting: false });\n    this.handleEvent('handleMouseUp', ev);\n    this.snapshot();\n  }\n\n  handleMouseMove(ev) {\n    if (this.state.isToolExecuting) {\n      this.handleEvent('handleMouseMove', ev);\n    }\n  }\n\n  render() {\n    return (\n      <div\n        onClick={(ev) => this.handleClick(ev)}\n        onMouseDown={(ev) => this.handleMouseDown(ev)}\n        onMouseUp={(ev) => this.handleMouseUp(ev)}\n        onMouseMove={(ev) => this.handleMouseMove(ev)}\n      >\n        <div className='Canvas'>\n          <Layer ref={l => this.layer = l} />\n          <Layer ref={l => this.shadowLayer = l} />\n          <Grid />\n        </div>\n      </div>\n    );\n  };\n};\n\nconst mapStateToProps = (state) => ({\n  color: state.color,\n  scale: state.scale,\n  tool: state.tool,\n  canvas: state.canvas,\n  width: state.width,\n  height: state.height,\n});\n\nconst mapDispatchToProps = {\n  updateCanvas,\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Workspace);\n\n\n\n// WEBPACK FOOTER //\n// containers/Workspace.js"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;AACA;AAAA;AACA;AADA;AACA;AAAA;AACA;AACA;AADA;AAFA;AAKA;AACA;;;AACA;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AACA;;;AAEA;AACA;AADA;AAAA;AAAA;AAAA;AAGA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AANA;AAQA;;;AAEA;AACA;AAAA;AAAA;AACA;AACA;;;AAEA;AACA;AAAA;AAAA;AACA;AACA;AACA;;;AAEA;AACA;AAAA;AAAA;AACA;AACA;AACA;;;AAEA;AACA;AACA;AACA;AACA;;;AAEA;AAAA;AACA;AAAA;AAEA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AAJA;AAAA;AAAA;AAAA;AAAA;AAMA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAIA;;;;AApEA;AACA;AAoEA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AANA;AAAA;AACA;AAQA;AACA;AADA;AAIA;;;;A","sourceRoot":""}